0
00:00:00,180 --> 00:00:01,971
RAFAEL IRIZARRY: In this video, we&#39;re going

1
00:00:01,971 --> 00:00:06,360
to show you how to compute distance in R. We&#39;re going to use this data set

2
00:00:06,360 --> 00:00:08,430
that we have been using as an example.

3
00:00:08,430 --> 00:00:18,680
It includes gene expression measurements for 189 samples on about 22,000 genes,

4
00:00:18,680 --> 00:00:23,800
and it is-- let&#39;s look at that real quick.

5
00:00:23,800 --> 00:00:31,100
It&#39;s saved in the object e, and each column represents a tissue.

6
00:00:31,100 --> 00:00:33,250
These are from the public repositories.

7
00:00:33,250 --> 00:00:36,190
Each tissue is very likely from a different person,

8
00:00:36,190 --> 00:00:39,710
and we can look at which tissue each column represents

9
00:00:39,710 --> 00:00:44,510
by looking at this vector tissue that just lists them out

10
00:00:44,510 --> 00:00:46,130
as a character vector.

11
00:00:46,130 --> 00:00:48,800
So we can see we have several tissues.

12
00:00:48,800 --> 00:00:52,693
We can use a function table and see how much of each one we have.

13
00:00:52,693 --> 00:00:57,650
All right, now let&#39;s go straight in to calculating distances.

14
00:00:57,650 --> 00:01:01,290
Let&#39;s say we want to compute the distance between two samples.

15
00:01:01,290 --> 00:01:04,890
Let&#39;s take two at random, take the first two.

16
00:01:04,890 --> 00:01:10,560
That&#39;s the first column, represents the first sample, and then the second,

17
00:01:10,560 --> 00:01:15,400
and I&#39;m going to pick a third at random, 87.

18
00:01:15,400 --> 00:01:18,470
Now, let&#39;s see what those tissues are just

19
00:01:18,470 --> 00:01:22,560
to see what we&#39;re working with here.

20
00:01:22,560 --> 00:01:28,040
They are two kidneys and a colon, so we expect the first two

21
00:01:28,040 --> 00:01:33,440
to be closer to each other than the last one because they&#39;re different issues.

22
00:01:33,440 --> 00:01:36,700
And their gene expression profile, these points,

23
00:01:36,700 --> 00:01:39,960
are expected to be closer if they&#39;re the same tissue.

24
00:01:39,960 --> 00:01:41,460
So how do we compute distance?

25
00:01:41,460 --> 00:01:43,650
Well, the formula we showed in class tells us we

26
00:01:43,650 --> 00:01:49,190
take the difference between each entry of x and y,

27
00:01:49,190 --> 00:01:52,240
square that and then take the sum.

28
00:01:52,240 --> 00:01:55,520
That gives us the square of the distance, so we take the square root

29
00:01:55,520 --> 00:01:56,610
and that should be it.

30
00:01:56,610 --> 00:01:59,440
That should give us the distance between x and y.

31
00:01:59,440 --> 00:02:01,880
Let&#39;s see if that works.

32
00:02:01,880 --> 00:02:06,240
It says it&#39;s 85.8546.

33
00:02:06,240 --> 00:02:10,250
Now, let&#39;s look at the same thing for the distance

34
00:02:10,250 --> 00:02:13,340
between the first and third tissue, and we get 122.

35
00:02:13,340 --> 00:02:16,050
As expected, it&#39;s a bigger number.

36
00:02:16,050 --> 00:02:21,880
All right, in the videos, we also showed how we can use matrix algebra.

37
00:02:21,880 --> 00:02:25,150
So we take x minus y, define that as a difference

38
00:02:25,150 --> 00:02:30,460
and then take the cross product of that with itself, we

39
00:02:30,460 --> 00:02:32,420
should get the same answer.

40
00:02:32,420 --> 00:02:34,550
So let&#39;s try it.

41
00:02:34,550 --> 00:02:38,360
I would write crossprod and then just x minus y.

42
00:02:38,360 --> 00:02:39,110
It&#39;s that simple.

43
00:02:39,110 --> 00:02:41,580
Now, we have to take the square root of that

44
00:02:41,580 --> 00:02:47,010
and that should give us 85.8546 because it&#39;s the same calculation.

45
00:02:47,010 --> 00:02:50,650
And there it is, and we can do the same for y minus z

46
00:02:50,650 --> 00:02:53,140
and again, get the same answer.

47
00:02:53,140 --> 00:02:54,020
Great.

48
00:02:54,020 --> 00:02:59,510
Now, if we wanted to compute the distances between each pair of samples,

49
00:02:59,510 --> 00:03:03,260
there&#39;s a function that does that and it&#39;s called dist.

50
00:03:03,260 --> 00:03:07,620
So we can look at the help file for dist, and there it is.

51
00:03:07,620 --> 00:03:09,720
And we can read that and see that it computes

52
00:03:09,720 --> 00:03:13,740
the distance between every row in x.

53
00:03:13,740 --> 00:03:17,970
So we would apply that to e, but we want the distance between each column,

54
00:03:17,970 --> 00:03:19,400
those are the samples.

55
00:03:19,400 --> 00:03:23,480
And the way we do achieve that is by taking the transpose so

56
00:03:23,480 --> 00:03:28,330
that the rows are columns, and now we get the distance between each column.

57
00:03:28,330 --> 00:03:30,330
Let&#39;s put that into d.

58
00:03:30,330 --> 00:03:32,260
A word of warning.

59
00:03:32,260 --> 00:03:34,980
If I type dist of e without the transpose,

60
00:03:34,980 --> 00:03:38,460
I might crash my R session, because we&#39;re

61
00:03:38,460 --> 00:03:49,500
asking R to compute the distance between 22,215, choose two pairs.

62
00:03:49,500 --> 00:03:53,350
So every pair of genes, that&#39;s a big number.

63
00:03:53,350 --> 00:03:57,430
So to store all that information, we have to create a gigantic object.

64
00:03:57,430 --> 00:03:59,700
You might not have enough memory for that.

65
00:03:59,700 --> 00:04:02,820
But here we&#39;re taking the transpose, that should give us a 189

66
00:04:02,820 --> 00:04:05,890
by 189 matrix of distances.

67
00:04:05,890 --> 00:04:10,020
Remember, for each pair we have a distance, each pair of columns

68
00:04:10,020 --> 00:04:12,020
gives us a distance.

69
00:04:12,020 --> 00:04:15,680
Now, this is an object of class dist.

70
00:04:15,680 --> 00:04:18,050
It isn&#39;t that easy to work with.

71
00:04:18,050 --> 00:04:22,830
If we want to extract things like the distance between the first two samples,

72
00:04:22,830 --> 00:04:29,140
what I do is I turn it into a matrix and then use it as a matrix.

73
00:04:29,140 --> 00:04:34,910
And once it&#39;s turned into a matrix, now entry 1, 2

74
00:04:34,910 --> 00:04:39,160
gives us the distance between the first and the second column,

75
00:04:39,160 --> 00:04:43,690
so that should be 85.8546, and there is.

76
00:04:43,690 --> 00:04:48,550
And then the same thing for the entry 1-- what was it?

77
00:04:48,550 --> 00:04:49,590
87.

78
00:04:49,590 --> 00:04:53,250
That should be 122, I think it was.

79
00:04:53,250 --> 00:04:54,300
And there it is.

80
00:04:54,300 --> 00:04:57,270
OK, so that&#39;s how this function dist works.

81
00:04:57,270 --> 00:04:59,360
It&#39;s very useful.

82
00:04:59,360 --> 00:05:00,529
I use it often.

83
00:05:00,529 --> 00:05:02,070
One other thing I wanted to show you.

84
00:05:02,070 --> 00:05:04,980
Is that if you wanted to visualize all the distances,

85
00:05:04,980 --> 00:05:09,480
you could use the image function and just type as.matrix.d, and you&#39;re

86
00:05:09,480 --> 00:05:15,930
going to get a color image of all the distances,

87
00:05:15,930 --> 00:05:19,840
so that&#39;s that 189 by 189 matrix.

88
00:05:19,840 --> 00:05:22,840
The top triangle and the bottom triangle should be the same

89
00:05:22,840 --> 00:05:24,970
because the distance between x and y is the same

90
00:05:24,970 --> 00:05:27,286
as the distance between y and x.

91
00:05:27,286 --> 00:05:29,550
And you can see these red squares.

92
00:05:29,550 --> 00:05:34,590
Those red squares are there because the samples are somewhat

93
00:05:34,590 --> 00:05:36,640
ordered by tissue so you have tissues that

94
00:05:36,640 --> 00:05:43,520
are close on the matrix are also close in biology or biology wise close,

95
00:05:43,520 --> 00:05:49,590
and then you get these reddish squares representing the distance

96
00:05:49,590 --> 00:05:51,460
between tissues of the same kind.

97
00:05:51,460 --> 00:05:55,720
Red is smaller and yellow is larger.

98
00:05:55,720 --> 00:06:00,550
OK, so that&#39;s how we compute distance using R.

